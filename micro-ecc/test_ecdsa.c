/* Copyright 2014, Kenneth MacKay. Licensed under the BSD 2-clause license. */

#include "uECC.h"

#include <stdio.h>
#include <string.h>


int main() {
    int i, c;
    uint8_t private[32] = {0};
    uint8_t public[64] = {0xDE,0xF9,0x74,0x09,0xA5,0x47,0x46,0xF8,0x6B,0xF2,0xCD,0x84,0x9F,0x78,0x6E,0x84,0x3C,0xB9,0xC6,0xA0,0xFB,0x1C,0xB5,0xD9,0xDC,0xC1,0x49,0x79,0xF9,0x56,0x21,0x2A,0xE7,0x2A,0x1A,0xE9,0xB4,0x2B,0xAC,0x9A,0x01,0x2E,0x29,0xEC,0x41,0xFC,0x7E,0xE3,0x67,0x01,0x6C,0x07,0xD9,0xA7,0xFC,0x2B,0xAD,0xC0,0x8C,0x26,0xE0,0x12,0xCB,0xC1};
    /*msg = AA*/
	uint8_t hash[32] = {0x57,0xbb,0x11,0x9c,0x35,0x51,0x3a,0x45,0x1d,0x24,0xdc,0x20,0xef,0x0e,0x90,0x31,0xec,0x85,0xb3,0x5b,0xfc,0x91,0x9d,0x26,0x3e,0x7e,0x5d,0x98,0x68,0x90,0x9c,0xb5};
    
	uint8_t sig[64] = {0xF8,0xF1,0xD2,0x6C,0xB4,0xD7,0xD6,0x38,0x49,0x59,0x4F,0x54,0x13,0x1C,0x54,0x1C,0xA8,0x05,0x3E,0x4A,0xA3,0xE4,0x0C,0x30,0x58,0x57,0x25,0x4D,0xCE,0x77,0x61,0xA6,0x24,0xA5,0xB0,0xD0,0x70,0x63,0x85,0x38,0x4A,0xAC,0xBE,0x52,0x8A,0x34,0xFE,0x1D,0x6C,0x87,0x11,0x02,0xBD,0xFF,0xC3,0x4A,0x7E,0xD8,0xA6,0x27,0x11,0xDB,0xA9,0xE0};

    const struct uECC_Curve_t * curves[5];
    int num_curves = 0;
#if uECC_SUPPORTS_secp160r1
    curves[num_curves++] = uECC_secp160r1();
#endif
#if uECC_SUPPORTS_secp192r1
    curves[num_curves++] = uECC_secp192r1();
#endif
#if uECC_SUPPORTS_secp224r1
    curves[num_curves++] = uECC_secp224r1();
#endif
#if uECC_SUPPORTS_secp256r1
    curves[num_curves++] = uECC_secp256r1();
#endif
#if uECC_SUPPORTS_secp256k1
    curves[num_curves++] = uECC_secp256k1();
#endif
    
    printf("Testing 256 signatures\n");
    for (c = 0; c < num_curves; ++c) {
        for (i = 0; i < 256; ++i) {
            printf(".");
            fflush(stdout);

            if (!uECC_verify(public, hash, sizeof(hash), sig, curves[c])) {
                printf("uECC_verify() failed\n");
                return 1;
            }
        }
        printf("\n");
    }
    
    return 0;
}
